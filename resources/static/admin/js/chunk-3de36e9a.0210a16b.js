(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3de36e9a","chunk-2d226c7d","chunk-2d20f8fc"],{2953:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("添加")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.list,pagination:!1,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},"row-key":"id"},scopedSlots:e._u([{key:"roles",fn:function(t){return a("span",{},e._l(t,(function(t,n){return a("a-tag",{key:n,attrs:{color:"blue"}},[e._v(e._s(t["name"]))])})),1)}},{key:"action",fn:function(t,n){return a("span",{},[a("a-button",{attrs:{icon:"edit"},on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),a("a-button",{attrs:{icon:"edit"},on:{click:function(t){return e.handleResetPassword(n)}}},[e._v("修改密码")]),a("a-popconfirm",{attrs:{title:"是否要强制下线？"},on:{confirm:function(t){return e.handleLogout(n.id)}}},[a("a-button",{attrs:{icon:"logout"}},[e._v("强制下线")])],1)],1)}}])}),e.total_page>0?a("a-pagination",{staticClass:"ant-table-pagination",attrs:{"page-size":e.params.page_size,total:e.params.total_count,"show-less-items":""},on:{"update:pageSize":function(t){return e.$set(e.params,"page_size",t)},"update:page-size":function(t){return e.$set(e.params,"page_size",t)},change:e.onChange},model:{value:e.params.current_page,callback:function(t){e.$set(e.params,"current_page",t)},expression:"params.current_page"}}):e._e(),a("create-form",{ref:"createModal",attrs:{visible:e.visible,loading:e.confirmLoading,model:e.mdl},on:{cancel:e.handleCancel,ok:e.handleOk}}),a("reset-password",{ref:"resetPassword",attrs:{visible:e.rs_visible,loading:e.confirmLoading,id:e.rw_id},on:{cancel:e.handleRSCancel,ok:e.handleRSOk}})],1)],1)},i=[],r=a("5530"),o=(a("68c7"),a("de1b")),s=a("e9b5"),l=a("b3c8"),c=a("4360"),d=a("8bbf"),u=a.n(d);u.a.use(o["a"]);var m={components:{CreateForm:s["default"],ResetPassword:l["default"]},props:{},data:function(){return{params:{current_page:1,page_size:10,total_count:0},total_page:0,selectedRowKeys:[],columns:[{title:"昵称",dataIndex:"nick_name",key:"nick_name"},{title:"用户名",dataIndex:"username",key:"username"},{title:"角色",dataIndex:"roles",key:"roles",scopedSlots:{customRender:"roles"}},{title:"创建时间",dataIndex:"create_at",key:"create_at"},{title:"操作",key:"id",fixed:"right",scopedSlots:{customRender:"action"}}],list:[],mdl:{id:0,username:"",phone:"",email:"",nick_name:"",sex:0,roles:[],status:1},confirmLoading:!1,visible:!1,rs_visible:!1,rw_id:0}},watch:{},computed:{},methods:{onSelectChange:function(e){this.selectedRowKeys=e},onChange:function(e){this.params.page=e,this.onload()},onload:function(){var e=this;c["a"].dispatch("getAdminList",this.params).then((function(t){0!==t.code&&e.$notification.error({message:"错误",description:t.message}),e.params.current_page=t.data.paginator.current_page,e.params.page_size=t.data.paginator.page_size,e.params.total_count=t.data.paginator.total_count,e.total_page=t.data.paginator.total_page,e.list=t.data.users})).catch((function(){e.$notification.error({message:"错误",description:"请求信息失败，请重试"})}))},handleAdd:function(){this.mdl={id:0,username:"",phone:"",email:"",nick_name:"",sex:0,roles:[],status:1},this.visible=!0},handleCancel:function(e){this.visible=!1,e.resetFields()},handleOk:function(e,t){var a=this;e.validate((function(n){return n?(t.id>0?c["a"].dispatch("updateAdmin",t).then((function(t){return 0!==t.code?(a.$notification.error({message:"错误",description:t.message}),!1):(a.visible=!1,a.confirmLoading=!1,e.resetFields(),a.onload(),a.$message.info("修改成功"),!0)})).catch((function(e){return a.$notification.error({message:"错误",description:"请求信息失败，请重试"}),!1})):c["a"].dispatch("addAdmin",t).then((function(t){return 0!==t.code?(a.$notification.error({message:"错误",description:t.message}),!1):(a.visible=!1,a.confirmLoading=!1,e.resetFields(),a.onload(),a.$message.info("新增成功"),!0)})).catch((function(e){return a.$notification.error({message:"错误",description:"请求信息失败，请重试"}),!1})),!0):(a.confirmLoading=!1,!1)}))},handleEdit:function(e){var t=this;this.visible=!0,this.confirmLoading=!0,c["a"].dispatch("showAdmin",e.id).then((function(e){if(0!==e.code)return t.$notification.error({message:"错误",description:e.message}),t.visible=!0,!1;t.mdl=Object(r["a"])({},e.data),t.confirmLoading=!1})).catch((function(e){return t.$notification.error({message:"错误",description:"请求信息失败，请重试"}),t.visible=!1,!1}))},handleDel:function(e){var t=this;this.$confirm({title:"你确定要删除选择的数据？",content:"确定删除后无法恢复.",okText:"是",okType:"danger",cancelText:"取消",onOk:function(){c["a"].dispatch("delPermission",e).then((function(e){if(0!==e.code)return t.$notification.error({message:"错误",description:e.message}),!1;t.onload(),t.$message.info("删除成功")})).catch((function(e){return t.$notification.error({message:"错误",description:"请求信息失败，请重试"}),!1}))}})},handleLogout:function(e){var t=this;c["a"].dispatch("logoutAdmin",e).then((function(e){if(0!==e.code)return t.$notification.error({message:"错误",description:e.message}),!1;t.$notification.success({message:"成功",description:"强制下线成功成功"})})).catch((function(e){return t.$notification.error({message:"错误",description:"请求信息失败，请重试"}),!1}))},handleResetPassword:function(e){this.rw_id=e.id,this.rs_visible=!0,this.confirmLoading=!1},handleRSCancel:function(e){this.rs_visible=!1,e.resetFields()},handleRSOk:function(e,t){var a=this;this.confirmLoading=!0,e.validate((function(n){return n?(c["a"].dispatch("adminResetPassword",t).then((function(t){return 0!==t.code?(a.$notification.error({message:"错误",description:t.message}),!1):(a.rs_visible=!1,a.confirmLoading=!1,e.resetFields(),a.onload(),a.$message.info("修改成功"),!0)})).catch((function(e){return a.$notification.error({message:"错误",description:"请求信息失败，请重试"}),a.confirmLoading=!1,!1})),!0):(a.confirmLoading=!1,!1)}))}},created:function(){this.onload()},mounted:function(){}},p=m,g=a("2877"),f=Object(g["a"])(p,n,i,!1,null,"cc67f67c",null);t["default"]=f.exports},b3c8:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"修改密码",width:860,visible:e.visible,confirmLoading:e.loading,"ok-text":"确认","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form-model",{ref:"ruleForm",attrs:{layout:"inline",model:e.model,rules:e.rules}},[a("a-form-model-item",{staticStyle:{width:"50%","margin-right":"0"},attrs:{label:"用户密码","label-col":{span:7},"wrapper-col":{span:17},prop:"password"}},[a("a-input",{model:{value:e.model.password,callback:function(t){e.$set(e.model,"password",t)},expression:"model.password"}})],1)],1)],1)],1)},i=[],r=(a("922d"),a("09d9")),o=(a("98a7"),a("7bec")),s=(a("17ac"),a("ff57")),l=(a("a9e3"),a("8bbf")),c=a.n(l);c.a.use(s["a"]),c.a.use(o["a"]),c.a.use(r["a"]);var d={props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},id:{type:Number,default:function(){return 0}}},data:function(){return{model:{password:"",id:0},rules:{password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:8,max:32,message:"长度在 8 到 32 个字符",trigger:"blur"}]}}},created:function(){},mounted:function(){},methods:{handleOk:function(){return this.model.id=this.id,this.$emit("ok",this.$refs.ruleForm,this.model)},handleCancel:function(){return this.$emit("cancel",this.$refs.ruleForm)}}},u=d,m=a("2877"),p=Object(m["a"])(u,n,i,!1,null,null,null);t["default"]=p.exports},e9b5:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.model.id>0?"管理员编辑":"管理员新增",width:860,visible:e.visible,confirmLoading:e.loading,"ok-text":"确认","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form-model",{ref:"ruleForm",attrs:{layout:"inline",model:e.model,rules:e.rules}},[e.model&&e.model.id>0?a("a-form-model-item",{staticStyle:{width:"88%","margin-right":"0"},attrs:{"label-col":{span:4},"wrapper-col":{span:5},label:"主键ID",prop:"id"}},[a("a-input",{attrs:{disabled:""},model:{value:e.model.id,callback:function(t){e.$set(e.model,"id",t)},expression:"model.id"}})],1):e._e(),a("a-form-model-item",{staticStyle:{width:"50%","margin-right":"0"},attrs:{label:"用户名称","label-col":{span:7},"wrapper-col":{span:17},prop:"username"}},[a("a-input",{model:{value:e.model.username,callback:function(t){e.$set(e.model,"username",t)},expression:"model.username"}})],1),a("a-form-model-item",{staticStyle:{width:"50%","margin-right":"0"},attrs:{label:"手机号码","label-col":{span:7},"wrapper-col":{span:17},prop:"phone"}},[a("a-input",{model:{value:e.model.phone,callback:function(t){e.$set(e.model,"phone",t)},expression:"model.phone"}})],1),a("a-form-model-item",{staticStyle:{width:"50%","margin-right":"0"},attrs:{label:"邮箱","label-col":{span:7},"wrapper-col":{span:17},prop:"email"}},[a("a-input",{model:{value:e.model.email,callback:function(t){e.$set(e.model,"email",t)},expression:"model.email"}})],1),a("a-form-model-item",{staticStyle:{width:"50%","margin-right":"0"},attrs:{label:"用户昵称","label-col":{span:7},"wrapper-col":{span:17},prop:"nick_name"}},[a("a-input",{model:{value:e.model.nick_name,callback:function(t){e.$set(e.model,"nick_name",t)},expression:"model.nick_name"}})],1),e.model&&0===e.model.id?a("a-form-model-item",{staticStyle:{width:"50%","margin-right":"0"},attrs:{label:"用户密码","label-col":{span:7},"wrapper-col":{span:17},prop:"password"}},[a("a-input",{model:{value:e.model.password,callback:function(t){e.$set(e.model,"password",t)},expression:"model.password"}})],1):e._e(),a("a-form-model-item",{staticStyle:{width:"50%","margin-right":"0"},attrs:{"label-col":{span:7},"wrapper-col":{span:17},label:"用户性别",prop:"sex"}},[a("a-select",{model:{value:e.model.sex,callback:function(t){e.$set(e.model,"sex",t)},expression:"model.sex"}},e._l(e.sexOptions,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value||0}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("a-form-model-item",{staticStyle:{width:"88%","margin-right":"0"},attrs:{"label-col":{span:4},"wrapper-col":{span:16},label:"角色",prop:"roles"}},[a("a-tree-select",{attrs:{"replace-fields":{children:"children",title:"name",key:"id",value:"id"},"tree-data":e.list,"tree-checkable":"","show-checked-strategy":"SHOW_PARENT"},model:{value:e.model.roles,callback:function(t){e.$set(e.model,"roles",t)},expression:"model.roles"}})],1),a("a-form-model-item",{staticStyle:{width:"88%","margin-right":"0"},attrs:{label:"管理员状态","label-col":{span:4},"wrapper-col":{span:10},prop:"status"}},[a("a-radio-group",{attrs:{name:"status"},model:{value:e.model.status,callback:function(t){e.$set(e.model,"status",t)},expression:"model.status"}},[a("a-radio",{attrs:{value:1}},[e._v("开启")]),a("a-radio",{attrs:{value:0}},[e._v("关闭")])],1)],1)],1)],1)],1)},i=[],r=(a("922d"),a("09d9")),o=(a("98a7"),a("7bec")),s=(a("17ac"),a("ff57")),l=a("8bbf"),c=a.n(l),d=a("4360");c.a.use(s["a"]),c.a.use(o["a"]),c.a.use(r["a"]);var u={props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}}},data:function(){return{sexOptions:[{label:"未公开",value:0},{label:"男",value:1},{label:"女",value:2}],form:{id:0,username:"",phone:"",email:"",nick_name:"",sex:0,roles:[],status:1},list:[],rules:{id:[{required:!0,message:"不能空",trigger:"blur"},{type:"integer",min:0,message:"不正确",trigger:"blur"}],username:[{required:!0,message:"不能为空",trigger:"blur"},{min:1,max:32,message:"范围 1 - 32 字符",trigger:"blur"},{validator:this.validateUsername,trigger:"blur"}],nick_name:[{required:!0,message:"不能为空",trigger:"blur"},{min:1,max:32,message:"范围 1 - 32 字符",trigger:"blur"}],phone:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:8,max:32,message:"长度在 8 到 32 个字符",trigger:"blur"}],email:[{required:!0,message:"邮箱地址不能为空",trigger:"blur"},{type:"email",message:"'请输入正确的邮箱地址",trigger:["blur","change"]}],sex:[{required:!0,message:"不能空",trigger:"blur"},{type:"enum",enum:[0,1,2],message:"类型不正确",trigger:"blur"}],status:[{required:!0,message:"不能空",trigger:"blur"},{type:"enum",enum:[0,1],message:"类型不正确",trigger:"blur"}]}}},created:function(){},mounted:function(){this.getList()},methods:{handleOk:function(){return this.$emit("ok",this.$refs.ruleForm,this.model)},handleCancel:function(){return this.$emit("cancel",this.$refs.ruleForm)},getList:function(){var e=this,t=this;d["a"].dispatch("getRoleAll",{type:this.model.type}).then((function(a){0!==a.code&&e.$notification.error({message:"错误",description:a.message}),t.list=a.data.roles})).catch((function(){e.$notification.error({message:"错误",description:"请求信息失败，请重试"})}))},validateUsername:function(e,t,a,n,i){d["a"].dispatch("adminUsernameExist",{username:t,id:this.model.id}).then((function(e){return 0!==e.code?a(new Error("用户名已存在")):a()})).catch((function(){return a(new Error("用户名已存在"))}))}}},m=u,p=a("2877"),g=Object(p["a"])(m,n,i,!1,null,null,null);t["default"]=g.exports}}]);