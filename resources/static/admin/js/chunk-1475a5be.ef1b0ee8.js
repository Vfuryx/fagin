(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1475a5be","chunk-2d0e9934"],{4527:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("添加")])],1),a("a-tabs",{attrs:{"default-active-key":0,animated:!1},on:{change:e.tabChange}},[a("a-tab-pane",{key:0,attrs:{tab:"总后台"}},[a("a-table",{attrs:{columns:e.columns,"data-source":e.list,pagination:!1,"row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange},"row-key":"id"},scopedSlots:e._u([{key:"group",fn:function(t){return a("span",{},[a("a-tag",{attrs:{color:"blue"}},[e._v(e._s(t||"暂无"))])],1)}},{key:"method",fn:function(t){return a("span",{},[a("a-tag",{attrs:{color:"blue"}},[e._v(e._s(t||"暂无"))])],1)}},{key:"status",fn:function(e,t){return a("span",{},[a("a-badge",{attrs:{color:t.status?"green":"red",status:t.status?"processing":"default",text:t.status?"开启":"关闭"}})],1)}},{key:"action",fn:function(t,n){return a("span",{},[a("a-button",{attrs:{icon:"edit"},on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),a("a-popconfirm",{attrs:{title:"是否要删除接口？"},on:{confirm:function(t){return e.handleDelete(n.id)}}},[a("a-button",{attrs:{icon:"user-delete"}},[e._v("删除接口")])],1)],1)}}])},[e._v('showPagination="auto" ')])],1),a("a-tab-pane",{key:1,attrs:{tab:"商家"}},[a("a-table",{attrs:{columns:e.columns,"data-source":e.list,pagination:!1,"row-key":"id"},scopedSlots:e._u([{key:"group",fn:function(t){return a("span",{},[a("a-tag",{attrs:{color:"blue"}},[e._v(e._s(t||"暂无"))])],1)}},{key:"method",fn:function(t){return a("span",{},[a("a-tag",{attrs:{color:"blue"}},[e._v(e._s(t||"暂无"))])],1)}},{key:"status",fn:function(e,t){return a("span",{},[a("a-badge",{attrs:{color:t.status?"green":"red",status:t.status?"processing":"default",text:t.status?"开启":"关闭"}})],1)}},{key:"action",fn:function(t,n){return a("span",{},[a("a-button",{attrs:{icon:"edit"},on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑1")]),a("a-popconfirm",{attrs:{title:"是否要删除接口？"},on:{confirm:function(t){return e.handleDelete(n.id)}}},[a("a-button",{attrs:{icon:"user-delete"}},[e._v("删除接口")])],1)],1)}}])})],1)],1),e.total_page>0?a("a-pagination",{staticClass:"ant-table-pagination",attrs:{"page-size":e.params.page_size,total:e.params.total_count,"show-less-items":""},on:{"update:pageSize":function(t){return e.$set(e.params,"page_size",t)},"update:page-size":function(t){return e.$set(e.params,"page_size",t)},change:e.onChange},model:{value:e.params.current_page,callback:function(t){e.$set(e.params,"current_page",t)},expression:"params.current_page"}}):e._e(),a("create-form",{ref:"createModal",attrs:{visible:e.visible,loading:e.confirmLoading,model:e.mdl},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)],1)},s=[],o=a("5530"),i=(a("68c7"),a("de1b")),r=a("8db4"),l=a("4360"),d=a("8bbf"),c=a.n(d);c.a.use(i["a"]);var u={components:{CreateForm:r["default"]},props:{},data:function(){return{params:{current_page:1,page_size:10,total_count:0,type:0},total_page:0,searchConfig:[{label:"接口名称",name:"name",type:"text"},{label:"接口路由",name:"apis",type:"text"},{label:"所属分组",name:"pid",type:"select",data:[{label:"全部",value:""}]}],selectedRowKeys:[],columns:[{title:"接口名称",dataIndex:"name",key:"name"},{title:"所属分组",dataIndex:"group",key:"group",scopedSlots:{customRender:"group"}},{title:"接口路由",dataIndex:"paths",key:"paths"},{title:"请求方法",dataIndex:"method",key:"method",scopedSlots:{customRender:"method"}},{title:"菜单状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"排序",dataIndex:"sort",key:"sort",width:"100px"},{title:"操作",key:"id",fixed:"right",scopedSlots:{customRender:"action"}}],list:[],confirmLoading:!1,mdl:{id:0,gid:0,type:0,name:"",paths:"",method:"GET",sort:0,status:1},visible:!1}},watch:{},computed:{},methods:{onSelectChange:function(e){this.selectedRowKeys=e},onChange:function(e){this.params.current_page=e,this.onload()},tabChange:function(e){this.list=[],this.total_page=0,this.to_nav(e)},to_nav:function(e){this.params.type=e,this.params.current_page=1,this.onload()},onload:function(){var e=this;l["a"].dispatch("getPermissionList",this.params).then((function(t){0!==t.code&&e.$notification.error({message:"错误",description:t.message}),e.params.current_page=t.data.paginator.current_page,e.params.page_size=t.data.paginator.page_size,e.params.total_count=t.data.paginator.total_count,e.total_page=t.data.paginator.total_page,e.list=t.data.list})).catch((function(){e.$notification.error({message:"错误",description:"请求信息失败，请重试"})}))},handleAdd:function(){this.mdl={id:0,gid:0,type:0,name:"",paths:"",method:"GET",sort:0,status:1},this.visible=!0},handleCancel:function(e){this.visible=!1,e.resetFields()},handleOk:function(e,t){var a=this;e.validate((function(n){return n?(t.id>0?l["a"].dispatch("updatePermission",t).then((function(t){return 0!==t.code?(a.$notification.error({message:"错误",description:t.message}),!1):(a.visible=!1,a.confirmLoading=!1,e.resetFields(),a.onload(),a.$message.info("修改成功"),!0)})).catch((function(e){return a.$notification.error({message:"错误",description:"请求信息失败，请重试"}),!1})):l["a"].dispatch("addPermission",t).then((function(t){return 0!==t.code?(a.$notification.error({message:"错误",description:t.message}),!1):(a.visible=!1,a.confirmLoading=!1,e.resetFields(),a.onload(),a.$message.info("新增成功"),!0)})).catch((function(e){return a.$notification.error({message:"错误",description:"请求信息失败，请重试"}),!1})),!0):(a.confirmLoading=!1,!1)}))},handleEdit:function(e){var t=this;this.visible=!0,this.confirmLoading=!0,l["a"].dispatch("showPermission",e.id).then((function(e){if(0!==e.code)return t.$notification.error({message:"错误",description:e.message}),t.visible=!1,!1;t.mdl=Object(o["a"])({},e.data),t.confirmLoading=!1})).catch((function(e){return t.$notification.error({message:"错误",description:"请求信息失败，请重试"}),t.visible=!1,!1}))},handleDelete:function(e){var t=this;l["a"].dispatch("delPermission",e).then((function(e){if(0!==e.code)return t.$notification.error({message:"错误",description:e.message}),!1;t.onload(),t.$message.info("删除成功")})).catch((function(e){return t.$notification.error({message:"错误",description:"请求信息失败，请重试"}),!1}))}},created:function(){this.onload()},mounted:function(){}},p=u,m=a("2877"),g=Object(m["a"])(p,n,s,!1,null,"3f4957cc",null);t["default"]=g.exports},"8db4":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.model.id>0?"权限编辑":"权限新增",width:860,visible:e.visible,confirmLoading:e.loading,"ok-text":"确认","cancel-text":"取消"},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form-model",{ref:"ruleForm",attrs:{layout:"inline",model:e.model,rules:e.rules}},[e.model&&e.model.id>0?a("a-form-model-item",{staticStyle:{width:"100%","margin-right":"0"},attrs:{"label-col":{span:5},"wrapper-col":{span:5},label:"主键ID",prop:"id"}},[a("a-input",{attrs:{disabled:""},model:{value:e.model.id,callback:function(t){e.$set(e.model,"id",t)},expression:"model.id"}})],1):e._e(),a("a-form-model-item",{staticStyle:{width:"100%","margin-right":"0"},attrs:{"label-col":{span:5},"wrapper-col":{span:10},label:"权限类型",prop:"type"}},[a("a-select",{on:{change:e.typeChange},model:{value:e.model.type,callback:function(t){e.$set(e.model,"type",t)},expression:"model.type"}},[a("a-select-option",{attrs:{value:0}},[e._v("后台菜单")]),a("a-select-option",{attrs:{value:1}},[e._v("商家菜单")])],1)],1),a("a-form-model-item",{staticStyle:{width:"100%","margin-right":"0"},attrs:{"label-col":{span:5},"wrapper-col":{span:10},label:"所属分组",prop:"gid"}},[a("a-select",{model:{value:e.model.gid,callback:function(t){e.$set(e.model,"gid",t)},expression:"model.gid"}},[a("a-select-option",{key:0,attrs:{value:0}},[e._v(" 未选择 ")]),e._l(e.list,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.id||0}},[e._v(" "+e._s(t.name)+" ")])}))],2)],1),a("a-form-model-item",{staticStyle:{width:"100%","margin-right":"0"},attrs:{label:"接口名称","label-col":{span:5},"wrapper-col":{span:16},prop:"name"}},[a("a-input",{model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),a("a-form-model-item",{staticStyle:{width:"100%","margin-right":"0"},attrs:{label:"路径","label-col":{span:5},"wrapper-col":{span:16},prop:"paths"}},[a("a-input",{model:{value:e.model.paths,callback:function(t){e.$set(e.model,"paths",t)},expression:"model.paths"}})],1),a("a-form-model-item",{staticStyle:{width:"100%","margin-right":"0"},attrs:{label:"请求方式","label-col":{span:5},"wrapper-col":{span:18},prop:"method"}},[a("a-radio-group",{attrs:{name:"is_show"},model:{value:e.model.method,callback:function(t){e.$set(e.model,"method",t)},expression:"model.method"}},[a("a-radio",{attrs:{value:"GET"}},[e._v("GET")]),a("a-radio",{attrs:{value:"POST"}},[e._v("POST")]),a("a-radio",{attrs:{value:"PUT"}},[e._v("PUT")]),a("a-radio",{attrs:{value:"DELETE"}},[e._v("DELETE")])],1)],1),a("a-form-model-item",{staticStyle:{width:"100%","margin-right":"0"},attrs:{label:"显示排序","label-col":{span:5},"wrapper-col":{span:5},prop:"sort"}},[a("a-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.model.sort,callback:function(t){e.$set(e.model,"sort",t)},expression:"model.sort"}})],1),a("a-form-model-item",{staticStyle:{width:"100%","margin-right":"0"},attrs:{label:"菜单状态","label-col":{span:5},"wrapper-col":{span:18},prop:"status"}},[a("a-radio-group",{attrs:{name:"status"},model:{value:e.model.status,callback:function(t){e.$set(e.model,"status",t)},expression:"model.status"}},[a("a-radio",{attrs:{value:1}},[e._v("开启")]),a("a-radio",{attrs:{value:0}},[e._v("关闭")])],1)],1)],1)],1)],1)},s=[],o=(a("922d"),a("09d9")),i=(a("98a7"),a("7bec")),r=(a("17ac"),a("ff57")),l=a("8bbf"),d=a.n(l),c=a("4360");d.a.use(r["a"]),d.a.use(i["a"]),d.a.use(o["a"]);var u={props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){return null}}},data:function(){return this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{labelCol:{span:10},wrapperCol:{span:14},form:{id:0,gid:0,type:0,name:"",paths:"",method:"GET",sort:0,status:1},list:[],rules:{id:[{required:!0,message:"不能空",trigger:"blur"},{type:"integer",min:0,message:"不正确",trigger:"blur"}],gid:[{required:!0,message:"不能空",trigger:"blur"},{type:"integer",min:1,message:"请选择",trigger:"blur"}],type:[{required:!0,message:"不能空",trigger:"blur"},{type:"enum",enum:[0,1],message:"类型不正确",trigger:"blur"}],name:[{required:!0,message:"不能为空",trigger:"blur"},{min:1,max:32,message:"范围 1 - 32 字符",trigger:"blur"}],paths:[{required:!0,message:"不能为空",trigger:"blur"},{min:1,max:128,message:"范围 1 - 128 字符",trigger:"blur"}],method:[{required:!0,message:"不能空",trigger:"blur"},{type:"enum",enum:["GET","POST","PUT","DELETE"],message:"类型不正确",trigger:"blur"}],sort:[{required:!0,message:"不能空",trigger:"blur"},{type:"integer",min:0,message:"上级不正确",trigger:"blur"}],status:[{required:!0,message:"不能空",trigger:"blur"},{type:"enum",enum:[0,1],message:"类型不正确",trigger:"blur"}]}}},created:function(){},mounted:function(){this.getList()},methods:{handleOk:function(){return this.$emit("ok",this.$refs.ruleForm,this.model)},handleCancel:function(){return this.$emit("cancel",this.$refs.ruleForm)},typeChange:function(){this.model.gid=0,this.getList()},getList:function(){var e=this,t=this;c["a"].dispatch("getPermissionGroupAll",{type:this.model.type}).then((function(a){0!==a.code&&e.$notification.error({message:"错误",description:a.message}),t.list=a.data})).catch((function(){e.$notification.error({message:"错误",description:"请求信息失败，请重试"})}))}}},p=u,m=a("2877"),g=Object(m["a"])(p,n,s,!1,null,null,null);t["default"]=g.exports}}]);