var Ue=Object.defineProperty,Ve=Object.defineProperties;var He=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var ue=(e,d,k)=>d in e?Ue(e,d,{enumerable:!0,configurable:!0,writable:!0,value:k}):e[d]=k,F=(e,d)=>{for(var k in d||(d={}))ze.call(d,k)&&ue(e,k,d[k]);if(oe)for(var k of oe(d))Xe.call(d,k)&&ue(e,k,d[k]);return e},G=(e,d)=>Ve(e,He(d));var he=(e,d,k)=>new Promise((K,L)=>{var a=C=>{try{A(k.next(C))}catch(v){L(v)}},p=C=>{try{A(k.throw(C))}catch(v){L(v)}},A=C=>C.done?K(C.value):Promise.resolve(C.value).then(a,p);A((k=k.apply(e,d)).next())});import{z as Ye,A as ye,aB as Ge,aA as Q,ao as Je,r as fe,j as O,S as j,T as We,a0 as m,B as M,D as V,a7 as qe,ad as P,a1 as Z,a6 as H,ae as ke,J as ge,K as Qe,w as S,ab as R,ap as Ze,aC as Re,aS as et,ay as tt,u as h,n as pe,P as Ke,t as z,c7 as nt,o as xe,am as X,_ as st,bw as at,F as Se,G as be,c8 as _e,a4 as ve,as as Ce,bx as ee}from"./vendor.3850bdb6.js";import{k as ct,I as te,aA as lt,p as b,b as rt,_ as it,aW as Ae,a as dt,ak as ot,j as ne,aX as ut,aD as ht,az as Te,U as yt,aY as ft,D as Le,af as kt}from"./index.6d3ed4e5.js";import{u as gt}from"./useContextMenu.f3a8e755.js";const pt=({icon:e})=>e?ct(e)?Ye(te,{icon:e,class:"mr-1"}):te:null;var De;(function(e){e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY"})(De||(De={}));const Kt=ye({name:"BasicTreeHeader",components:{BasicTitle:lt,Icon:te,Dropdown:Ge,Menu:Q,MenuItem:Q.Item,MenuDivider:Q.Divider,InputSearch:Je.Search},props:{helpMessage:{type:[String,Array],default:""},title:b.string,toolbar:b.bool,checkable:b.bool,search:b.bool,checkAll:b.func,expandAll:b.func,searchText:b.string},emits:["strictly-change","search"],setup(e,{emit:d,slots:k}){const{t:K}=rt(),L=fe(""),a=O(()=>{const n=k.headerTitle||e.title;return["mr-1","w-full",{["ml-5"]:n}]}),p=O(()=>{const{checkable:n}=e,c=[{label:K("component.tree.expandAll"),value:2},{label:K("component.tree.unExpandAll"),value:3,divider:n}];return n?[{label:K("component.tree.selectAll"),value:0},{label:K("component.tree.unSelectAll"),value:1,divider:n},...c,{label:K("component.tree.checkStrictly"),value:4},{label:K("component.tree.checkUnStrictly"),value:5}]:c});function A(n){var r,s,o,l;const{key:c}=n;switch(c){case 0:(r=e.checkAll)==null||r.call(e,!0);break;case 1:(s=e.checkAll)==null||s.call(e,!1);break;case 2:(o=e.expandAll)==null||o.call(e,!0);break;case 3:(l=e.expandAll)==null||l.call(e,!1);break;case 4:d("strictly-change",!1);break;case 5:d("strictly-change",!0);break}}function C(n){d("search",n)}const v=We(C,200);return j(()=>L.value,n=>{v(n)}),j(()=>e.searchText,n=>{n!==L.value&&(L.value=n)}),{t:K,toolbarList:p,handleMenuClick:A,searchValue:L,getInputSearchCls:a}}}),xt={class:"flex px-2 py-1.5 items-center basic-tree-header"},St={key:2,class:"flex flex-1 justify-self-stretch items-center cursor-pointer"};function bt(e,d,k,K,L,a){const p=m("BasicTitle"),A=m("InputSearch"),C=m("Icon"),v=m("MenuItem"),n=m("MenuDivider"),c=m("Menu"),r=m("Dropdown");return M(),V("div",xt,[e.$slots.headerTitle?qe(e.$slots,"headerTitle",{key:0},void 0,!0):P("",!0),!e.$slots.headerTitle&&e.title?(M(),Z(p,{key:1,helpMessage:e.helpMessage},{default:H(()=>[ke(ge(e.title),1)]),_:1},8,["helpMessage"])):P("",!0),e.search||e.toolbar?(M(),V("div",St,[e.search?(M(),V("div",{key:0,class:Qe(e.getInputSearchCls)},[S(A,{placeholder:e.t("common.searchText"),size:"small",allowClear:"",value:e.searchValue,"onUpdate:value":d[0]||(d[0]=s=>e.searchValue=s)},null,8,["placeholder","value"])],2)):P("",!0),e.toolbar?(M(),Z(r,{key:1,onClick:d[1]||(d[1]=tt(()=>{},["prevent"]))},{overlay:H(()=>[S(c,{onClick:e.handleMenuClick},{default:H(()=>[(M(!0),V(R,null,Ze(e.toolbarList,s=>(M(),V(R,{key:s.value},[S(v,Re(et({key:s.value})),{default:H(()=>[ke(ge(s.label),1)]),_:2},1040),s.divider?(M(),Z(n,{key:0})):P("",!0)],64))),128))]),_:1},8,["onClick"])]),default:H(()=>[S(C,{icon:"ion:ellipsis-vertical"})]),_:1})):P("",!0)])):P("",!0)])}var _t=it(Kt,[["render",bt],["__scopeId","data-v-05dbfd0e"]]);function vt(e,d){function k(n){const c=[],r=n||h(e),{key:s,children:o}=h(d);if(!o||!s)return c;for(let l=0;l<r.length;l++){const i=r[l];c.push(i[s]);const f=i[o];f&&f.length&&c.push(...k(f))}return c}function K(n){const c=[],r=n||h(e),{key:s,children:o}=h(d);if(!o||!s)return c;for(let l=0;l<r.length;l++){const i=r[l];i.disabled!==!0&&i.selectable!==!1&&c.push(i[s]);const f=i[o];f&&f.length&&c.push(...K(f))}return c}function L(n,c){const r=[],s=c||h(e),{key:o,children:l}=h(d);if(!l||!o)return r;for(let i=0;i<s.length;i++){const f=s[i],T=f[l];n===f[o]?(r.push(f[o]),T&&T.length&&r.push(...k(T))):T&&T.length&&r.push(...L(n,T))}return r}function a(n,c,r){if(!n)return;const s=r||h(e),{key:o,children:l}=h(d);if(!(!l||!o))for(let i=0;i<s.length;i++){const f=s[i],T=f[l];if(f[o]===n){s[i]=F(F({},s[i]),c);break}else T&&T.length&&a(n,c,f[l])}}function p(n=1,c,r=1){if(!n)return[];const s=[],o=c||h(e)||[];for(let l=0;l<o.length;l++){const i=o[l],{key:f,children:T}=h(d),J=f?i[f]:"",U=T?i[T]:[];s.push(J),U&&U.length&&r<n&&(r+=1,s.push(...p(n,U,r)))}return s}function A({parentKey:n=null,node:c,push:r="push"}){const s=pe(h(e));if(!n){s[r](c),e.value=s;return}const{key:o,children:l}=h(d);!l||!o||(Ae(s,i=>{if(i[o]===n)return i[l]=i[l]||[],i[l][r](c),!0}),e.value=s)}function C({parentKey:n=null,list:c,push:r="push"}){const s=pe(h(e));if(!(!c||c.length<1))if(n){const{key:o,children:l}=h(d);if(!l||!o)return;Ae(s,i=>{if(i[o]===n){i[l]=i[l]||[];for(let f=0;f<c.length;f++)i[l][r](c[f]);return e.value=s,!0}})}else for(let o=0;o<c.length;o++)s[r](c[o])}function v(n,c){if(!n)return;const r=c||h(e),{key:s,children:o}=h(d);if(!(!o||!s))for(let l=0;l<r.length;l++){const i=r[l],f=i[o];if(i[s]===n){r.splice(l,1);break}else f&&f.length&&v(n,i[o])}}return{deleteNodeByKey:v,insertNodeByKey:A,insertNodesByKey:C,filterByLevel:p,updateNodeByKey:a,getAllKeys:k,getChildrenKeys:L,getEnabledKeys:K}}const Ct={value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:b.string,toolbar:b.bool,search:b.bool,searchValue:b.string,checkStrictly:b.bool,clickRowToExpand:b.bool.def(!0),checkable:b.bool.def(!1),defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:b.bool.def(!1),replaceFields:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:null},rightMenuList:{type:Array},filterFn:{type:Function,default:null},highlight:{type:[Boolean,String],default:!1},expandOnSearch:b.bool.def(!1),checkOnSearch:b.bool.def(!1),selectedOnSearch:b.bool.def(!1)};function At(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}var Ft=ye({name:"BasicTree",inheritAttrs:!1,props:Ct,emits:["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],setup(e,{attrs:d,slots:k,emit:K,expose:L}){const a=Ke({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=Ke({startSearch:!1,searchText:"",searchData:[]}),A=fe([]),[C]=gt(),{prefixCls:v}=dt("basic-tree"),n=O(()=>{const{replaceFields:t}=e;return F({children:"children",title:"title",key:"key"},t)}),c=O(()=>{let t=G(F(F({blockNode:!0},d),e),{expandedKeys:a.expandedKeys,selectedKeys:a.selectedKeys,checkedKeys:a.checkedKeys,checkStrictly:a.checkStrictly,replaceFields:h(n),"onUpdate:expandedKeys":y=>{a.expandedKeys=y,K("update:expandedKeys",y)},"onUpdate:selectedKeys":y=>{a.selectedKeys=y,K("update:selectedKeys",y)},onCheck:(y,g)=>{let x=z(a.checkedKeys);if(ot(x)&&p.startSearch){const{key:_}=h(n);x=nt(x,U(g.node.$attrs.node[_])),g.checked&&x.push(g.node.$attrs.node[_]),a.checkedKeys=x}else a.checkedKeys=y;const u=z(a.checkedKeys);K("update:value",u),K("check",u,g)},onRightClick:Fe});return xe(t,"treeData","class")}),r=O(()=>p.startSearch?p.searchData:h(A)),s=O(()=>!r.value||r.value.length===0),{deleteNodeByKey:o,insertNodeByKey:l,insertNodesByKey:i,filterByLevel:f,updateNodeByKey:T,getAllKeys:J,getChildrenKeys:U,getEnabledKeys:Ne}=vt(A,n);function Ee(t,y){return!y&&e.renderIcon&&ne(e.renderIcon)?e.renderIcon(t):y}function Fe(g){return he(this,arguments,function*({event:t,node:y}){var E;const{rightMenuList:x=[],beforeRightClick:u}=e;let _={event:t,items:[]};if(u&&ne(u)){let D=yield u(y,t);Array.isArray(D)?_.items=D:Object.assign(_,D)}else _.items=x;!((E=_.items)==null?void 0:E.length)||C(_)})}function Y(t){a.expandedKeys=t}function Me(){return a.expandedKeys}function se(t){a.selectedKeys=t}function we(){return a.selectedKeys}function ae(t){a.checkedKeys=t}function Ie(){return a.checkedKeys}function ce(t){a.checkedKeys=t?Ne():[]}function W(t){a.expandedKeys=t?J():[]}function me(t){a.checkStrictly=t}j(()=>e.searchValue,t=>{t!==p.searchText&&(p.searchText=t)},{immediate:!0}),j(()=>e.treeData,t=>{t&&q(p.searchText)});function q(t){if(t!==p.searchText&&(p.searchText=t),K("update:searchValue",t),!t){p.startSearch=!1;return}const{filterFn:y,checkable:g,expandOnSearch:x,checkOnSearch:u,selectedOnSearch:_}=h(e);p.startSearch=!0;const{title:E,key:D}=h(n),w=[];if(p.searchData=ut(h(A),N=>{var I,$;const B=y?y(t,N,h(n)):($=(I=N[E])==null?void 0:I.includes(t))!=null?$:!1;return B&&w.push(N[D]),B},h(n)),x){const N=ht(p.searchData).map(B=>B[D]);N&&N.length&&Y(N)}u&&g&&w.length&&ae(w),_&&w.length&&se(w)}function Be(t,y){if(!(!e.clickRowToExpand||!y||y.length===0))if(!a.expandedKeys.includes(t))Y([...a.expandedKeys,t]);else{const g=[...a.expandedKeys],x=g.findIndex(u=>u===t);x!==-1&&g.splice(x,1),Y(g)}}X(()=>{A.value=e.treeData}),st(()=>{const t=parseInt(e.defaultExpandLevel);t>0?a.expandedKeys=f(t):e.defaultExpandAll&&W(!0)}),X(()=>{a.expandedKeys=e.expandedKeys}),X(()=>{a.selectedKeys=e.selectedKeys}),X(()=>{a.checkedKeys=e.checkedKeys}),j(()=>e.value,()=>{a.checkedKeys=z(e.value||[])}),j(()=>a.checkedKeys,()=>{const t=z(a.checkedKeys);K("update:value",t),K("change",t)}),X(()=>{a.checkStrictly=e.checkStrictly}),L({setExpandedKeys:Y,getExpandedKeys:Me,setSelectedKeys:se,getSelectedKeys:we,setCheckedKeys:ae,getCheckedKeys:Ie,insertNodeByKey:l,insertNodesByKey:i,deleteNodeByKey:o,updateNodeByKey:T,checkAll:ce,expandAll:W,filterByLevel:t=>{a.expandedKeys=f(t)},setSearchValue:t=>{q(t)},getSearchValue:()=>p.searchText});function $e(t){const{actionList:y}=e;if(!(!y||y.length===0))return y.map((g,x)=>{var _;let u=!0;return ne(g.show)?u=(_=g.show)==null?void 0:_.call(g,t):Le(g.show)&&(u=g.show),u?S("span",{key:x,class:`${v}__action`},[g.render(t)]):null})}function le({data:t,level:y}){if(!t)return null;const g=p.searchText,{highlight:x}=h(e);return t.map(u=>{var re;const{title:_,key:E,children:D}=h(n),w=xe(u,"title"),N=Ee(G(F({},u),{level:y}),u.icon),B=ee(u,D)||[],I=ee(u,_),$=g?I.indexOf(g):-1,Oe=p.startSearch&&!ft(g)&&x&&$!==-1,je=`color: ${Le(x)?"#f50":x}`,Pe=Oe?S("span",{class:((re=h(c))==null?void 0:re.blockNode)?`${v}__content`:""},[S("span",null,[I.substr(0,$)]),S("span",{style:je},[g]),S("span",null,[I.substr($+g.length)])]):I;return S(_e.TreeNode,ve(w,{node:z(u),key:ee(u,E)}),{title:()=>{var ie,de;return S("span",{class:`${v}-title pl-2`,onClick:Be.bind(null,u[E],u[D])},[((ie=u.slots)==null?void 0:ie.title)?kt(k,(de=u.slots)==null?void 0:de.title,u):S(R,null,[N&&S(pt,{icon:N},null),Pe,S("span",{class:`${v}__actions`},[$e(G(F({},u),{level:y}))])])])},default:()=>le({data:B,level:y+1})})})}return()=>{let t;const{title:y,helpMessage:g,toolbar:x,search:u,checkable:_}=e,E=y||x||u||k.headerTitle,D={height:"calc(100% - 38px)"};return S("div",{class:[v,"h-full",d.class]},[E&&S(_t,{checkable:_,checkAll:ce,expandAll:W,title:y,search:u,toolbar:x,helpMessage:g,onStrictlyChange:me,onSearch:q,searchText:p.searchText},At(t=Te(k))?t:{default:()=>[t]}),Se(S(yt,{style:D},{default:()=>[S(_e,ve(h(c),{showIcon:!1}),F({default:()=>le({data:h(r),level:1})},Te(k)))]}),[[be,!h(s)]]),Se(S(Ce,{image:Ce.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[be,h(s)]])])}}});export{Ft as _};
