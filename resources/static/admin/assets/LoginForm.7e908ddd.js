var L=(h,d,u)=>new Promise((i,v)=>{var l=n=>{try{f(u.next(n))}catch(p){v(p)}},w=n=>{try{f(u.throw(n))}catch(p){v(p)}},f=n=>n.done?i(n.value):Promise.resolve(n.value).then(l,w);f((u=u.apply(h,d)).next())});import{A,a$ as $,ao as k,r as F,P as j,j as U,u as e,_ as K,B as O,D as V,F as D,G as B,w as s,a6 as t,H as z,b0 as q,ae as m,J as g,aT as y,b1 as W,b2 as H,b3 as J,b4 as Q,b5 as X,b6 as Y,K as Z,b7 as ee,ab as se,b8 as ae,b9 as te}from"./vendor.3850bdb6.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               */import{u as le,a as oe,L as x,_ as ne,b as ie}from"./LoginFormTitle.b4a19668.js";import{b as re,a as de,f as ue,h as ce,i as me}from"./index.6d3ed4e5.js";const ge=["src"],Ce=A({setup(h){const d=ae,u=te,i=$.Item,v=k.Password,{t:l}=re(),{notification:w,createErrorModal:f}=me(),{prefixCls:n}=de("login"),p=ue(),{setLoginState:b,getLoginState:M}=le(),{getFormRules:G}=oe(),I=F(),C=F(!1),R=F(!1),c=j({account:"admin",password:"12345678",id:"",code:""}),_=j({data:"",id:""}),{validForm:N}=ie(I),T=U(()=>e(M)===x.LOGIN);function S(){ce().then(r=>{_.data=r.data,_.id=r.id})}function E(){return L(this,null,function*(){const r=yield N();if(!!r)try{C.value=!0;const a=yield p.login({password:r.password,username:r.account,id:_.id,code:r.code,mode:"none"});a&&w.success({message:l("sys.login.loginSuccessTitle"),description:`${l("sys.login.loginSuccessDesc")}: ${a.realName}`,duration:3})}catch(a){S(),f({title:l("sys.api.errorTip"),content:a.message||l("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{C.value=!1}})}return K(()=>{S()}),(r,a)=>(O(),V(se,null,[D(s(ne,{class:"enter-x"},null,512),[[B,e(T)]]),D(s(e($),{class:"p-4 enter-x",model:e(c),rules:e(G),ref:(o,P)=>{P.formRef=o,I.value=o},onKeypress:ee(E,["enter"])},{default:t(()=>[s(e(i),{name:"account",class:"enter-x"},{default:t(()=>[s(e(k),{size:"large",value:e(c).account,"onUpdate:value":a[0]||(a[0]=o=>e(c).account=o),placeholder:e(l)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(i),{name:"password",class:"enter-x"},{default:t(()=>[s(e(v),{size:"large",visibilityToggle:"",value:e(c).password,"onUpdate:value":a[1]||(a[1]=o=>e(c).password=o),placeholder:e(l)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(i),{name:"code",class:"enter-x"},{default:t(()=>[z("img",{onClick:S,src:e(_).data,class:"code",alt:""},null,8,ge),s(e(k),{size:"large",value:e(c).code,"onUpdate:value":a[2]||(a[2]=o=>e(c).code=o),placeholder:e(l)("sys.login.smsPlaceholder"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(u),{class:"enter-x"},{default:t(()=>[s(e(d),{span:12},{default:t(()=>[s(e(i),null,{default:t(()=>[s(e(q),{checked:R.value,"onUpdate:checked":a[3]||(a[3]=o=>R.value=o),size:"small"},{default:t(()=>[m(g(e(l)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(d),{span:12},{default:t(()=>[s(e(i),{style:{"text-align":"right"}},{default:t(()=>[s(e(y),{type:"link",size:"small",onClick:a[4]||(a[4]=o=>e(b)(e(x).RESET_PASSWORD))},{default:t(()=>[m(g(e(l)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(i),{class:"enter-x"},{default:t(()=>[s(e(y),{type:"primary",size:"large",block:"",onClick:E,loading:C.value},{default:t(()=>[m(g(e(l)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1}),s(e(u),{class:"enter-x"},{default:t(()=>[s(e(d),{md:8,xs:24},{default:t(()=>[s(e(y),{block:"",onClick:a[5]||(a[5]=o=>e(b)(e(x).MOBILE))},{default:t(()=>[m(g(e(l)("sys.login.mobileSignInFormTitle")),1)]),_:1})]),_:1}),s(e(d),{md:8,xs:24,class:"!my-2 !md:my-0 xs:mx-0 md:mx-2"},{default:t(()=>[s(e(y),{block:"",onClick:a[6]||(a[6]=o=>e(b)(e(x).QR_CODE))},{default:t(()=>[m(g(e(l)("sys.login.qrSignInFormTitle")),1)]),_:1})]),_:1}),s(e(d),{md:7,xs:24},{default:t(()=>[s(e(y),{block:"",onClick:a[7]||(a[7]=o=>e(b)(e(x).REGISTER))},{default:t(()=>[m(g(e(l)("sys.login.registerButton")),1)]),_:1})]),_:1})]),_:1}),s(e(W),{class:"enter-x"},{default:t(()=>[m(g(e(l)("sys.login.otherSignIn")),1)]),_:1}),z("div",{class:Z(["flex justify-evenly enter-x",`${e(n)}-sign-in-way`])},[s(e(H)),s(e(J)),s(e(Q)),s(e(X)),s(e(Y))],2)]),_:1},8,["model","rules","onKeypress"]),[[B,e(T)]])],64))}});export{Ce as default};
